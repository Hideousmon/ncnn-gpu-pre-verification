name: windows test
on:
  push:
    branches: [main]

jobs:
  windows-build:
    name: Build
    runs-on: windows-2019
    steps:
      - name: find mscvp
        shell: bash
        run: |
          ls "c:/Windows/System32/"  | Select-String 'mscvp*'

      - name: vc redist
        shell: powershell
        run: |
          Install-Module -Name "VcRedist" -Force
          Import-Module VcRedist
          $VcList = Get-VcList | Get-VcRedist -Path "D:/"
          $VcList | Install-VcRedist -Path D:/

      - name: find mscvp
        shell: bash
        run: |
          ls "c:/Windows/System32/"  | Select-String 'mscvp*'
